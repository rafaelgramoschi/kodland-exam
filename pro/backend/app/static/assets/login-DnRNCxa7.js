import{p as k,m as N,g as L,r as J,f as T,h as o,P as B,W as g,o as I,k as M,l as t,X as y,n as V}from"./index-DHkUxYI_.js";import{a as c}from"./axios-upsvKRUO.js";import{a as v,V as D}from"./VRow-CMh3EJEl.js";import{a as S,b as x,V as F,c as P}from"./VCard-BZih9Qg3.js";import{m as $,c as A,V as E}from"./VInput-D7eybHTs.js";import{f as G}from"./forwardRefs-DWGaNmQL.js";import{V as p}from"./VTextField-iCu7tDZH.js";import{V as b}from"./VSpacer-D6nTGYKr.js";import{k as R}from"./VGrid-YQ2L997K.js";const W=k({...N(),...$()},"VForm"),C=L()({name:"VForm",props:W(),emits:{"update:modelValue":u=>!0,submit:u=>!0},setup(u,m){let{slots:f,emit:r}=m;const a=A(u),l=J();function s(i){i.preventDefault(),a.reset()}function e(i){const d=i,n=a.validate();d.then=n.then.bind(n),d.catch=n.catch.bind(n),d.finally=n.finally.bind(n),r("submit",d),d.defaultPrevented||n.then(U=>{var w;let{valid:O}=U;O&&((w=l.value)==null||w.submit())}),d.preventDefault()}return T(()=>{var i;return o("form",{ref:l,class:["v-form",u.class],style:u.style,novalidate:!0,onReset:s,onSubmit:e},[(i=f.default)==null?void 0:i.call(f,a)])}),G(a,l)}}),_={__name:"login",setup(u){const m=B();async function f(l,s){var i,d;let e=null;await c.post("/auth/login",{username:l,password:s}).then(n=>e=n).catch(n=>console.log(n)),m.session.id=(i=e==null?void 0:e.data)==null?void 0:i.user.id,m.session.score=(d=e==null?void 0:e.data)==null?void 0:d.user.score,localStorage.setItem("session_id",m.session.id),localStorage.setItem("score",m.session.score),console.log("LOGIN PROCESS ->",e==null?void 0:e.status)}const r=g({isValid:!1,username:"",password:"",login:async()=>{if(!r.isValid)return!1;const l=JSON.parse(JSON.stringify(r));console.log("FORM::",l),await f(l.username,l.password)}}),a=g({isValid:!1,username:"",password:"",repeatPassword:"",signup:async()=>{if(!a.isValid)return!1;const l=JSON.parse(JSON.stringify(a));console.log("FORM::",l);let s=null;await c.post("/auth/signup",{username:l.username,password:l.password}).then(e=>s=e).catch(e=>console.log(e)),(s==null?void 0:s.status)==200&&await f(l.username,l.password)}});return(l,s)=>(I(),M(E,null,{default:t(()=>[o(D,null,{default:t(()=>[o(v,{cols:"12",sm:"6"},{default:t(()=>[o(S,{class:"text-center h-100"},{default:t(()=>[o(C,{modelValue:r.isValid,"onUpdate:modelValue":s[2]||(s[2]=e=>r.isValid=e),onSubmit:s[3]||(s[3]=y(e=>r.login(),["prevent"])),class:"d-flex flex-column h-100"},{default:t(()=>[o(x,null,{default:t(()=>s[9]||(s[9]=[V("Login")])),_:1}),o(F,{class:"mx-8"},{default:t(()=>[o(p,{density:"comfortable",label:"Username",modelValue:r.username,"onUpdate:modelValue":s[0]||(s[0]=e=>r.username=e),rules:[e=>!!e||"obbligatorio"]},null,8,["modelValue","rules"]),o(p,{density:"comfortable",label:"Password",type:"password",modelValue:r.password,"onUpdate:modelValue":s[1]||(s[1]=e=>r.password=e),rules:[e=>!!e||"obbligatorio"]},null,8,["modelValue","rules"])]),_:1}),o(P,null,{default:t(()=>[o(b),o(R,{type:"submit"},{default:t(()=>s[10]||(s[10]=[V("Login")])),_:1}),o(b)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1}),o(v,{cols:"12",sm:"6"},{default:t(()=>[o(S,{class:"text-center"},{default:t(()=>[o(C,{modelValue:a.isValid,"onUpdate:modelValue":s[7]||(s[7]=e=>a.isValid=e),onSubmit:s[8]||(s[8]=y(e=>a.signup(),["prevent"]))},{default:t(()=>[o(x,null,{default:t(()=>s[11]||(s[11]=[V("Registrati")])),_:1}),o(F,{class:"mx-8"},{default:t(()=>[o(p,{density:"comfortable",label:"Username",modelValue:a.username,"onUpdate:modelValue":s[4]||(s[4]=e=>a.username=e),rules:[e=>!!e||"obbligatorio"]},null,8,["modelValue","rules"]),o(p,{density:"comfortable",label:"Password",type:"password",modelValue:a.password,"onUpdate:modelValue":s[5]||(s[5]=e=>a.password=e),rules:[e=>!!e||"obbligatorio"]},null,8,["modelValue","rules"]),o(p,{density:"comfortable",label:"Ripeti Password",type:"password",modelValue:a.repeatPassword,"onUpdate:modelValue":s[6]||(s[6]=e=>a.repeatPassword=e),rules:[e=>e==a.password||"Le password sono diverse"]},null,8,["modelValue","rules"])]),_:1}),o(P,null,{default:t(()=>[o(b),o(R,{type:"submit"},{default:t(()=>s[12]||(s[12]=[V("Registrati")])),_:1}),o(b)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}))}};export{_ as default};
